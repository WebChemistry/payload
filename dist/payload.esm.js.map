{"version":3,"file":"payload.esm.js","sources":["../assets/payload.js"],"sourcesContent":["class PayloadResponse {\n\n\t/** @param {Number} */\n\t#code;\n\n\t/** @param {Array} */\n\t#meta;\n\n\t/** @param {Array} */\n\t#data;\n\n\t/** @param {Array} */\n\t#errors;\n\n\t#clientErrorProcessors;\n\n\t/** @var {PayloadExtension[]} */\n\t#extensions;\n\n\t/**\n\t * @param {PayloadExtension[]} extensions\n\t */\n\tconstructor(response, clientErrorProcessors, extensions) {\n\t\tthis.#clientErrorProcessors = clientErrorProcessors;\n\t\tthis.#extensions = extensions;\n\n\t\tif (typeof response !== 'object' || response === null) {\n\t\t\tthrow new Error('Response must be an object.');\n\t\t}\n\n\t\tif (typeof response.code !== 'number') {\n\t\t\tthrow new Error('Response code must be an number.');\n\t\t}\n\n\t\tthis.#code = response.code;\n\n\t\tif (!Array.isArray(response.meta)) {\n\t\t\tthrow new Error('Response meta must be an array.');\n\t\t}\n\n\t\tthis.#meta = response.meta;\n\n\t\tif (!Array.isArray(response.data)) {\n\t\t\tthrow new Error('Response data must be an array.');\n\t\t}\n\n\t\tthis.#data = response.data;\n\n\t\tif (!Array.isArray(response.errors)) {\n\t\t\tthrow new Error('Response errors must be an array.');\n\t\t}\n\n\t\tthis.#errors = response.errors.map(error => {\n\t\t\tif (typeof error.message !== 'string') {\n\t\t\t\tthrow new Error('Response error message must be a string.');\n\t\t\t}\n\n\t\t\tif (typeof error.type !== 'string') {\n\t\t\t\tthrow new Error('Response error type must be a string.');\n\t\t\t}\n\n\t\t\treturn error;\n\t\t});\n\n\t\tthis.#extensions.forEach(extension => extension.before(this));\n\n\t\tthis.#process();\n\n\t\tthis.#extensions.forEach(extension => extension.after(this));\n\t}\n\n\t#process() {\n\t\tthis.getCriticalErrors().forEach(error => {\n\t\t\tconsole.error(error.message)\n\t\t});\n\n\t\tthis.#clientErrorProcessors.forEach(processor => {\n\t\t\tthis.getClientErrors().forEach(error => {\n\t\t\t\tprocessor(error);\n\t\t\t})\n\t\t});\n\t}\n\n\tisSuccess() {\n\t\treturn this.#code >= 200 && this.#code < 300;\n\t}\n\n\tisError() {\n\t\treturn !this.isSuccess();\n\t}\n\n\thasErrors() {\n\t\treturn this.#errors.length !== 0;\n\t}\n\n\thasMeta(key) {\n\t\treturn typeof this.#meta[key] !== 'undefined';\n\t}\n\n\tgetMeta(key) {\n\t\treturn this.#meta[key];\n\t}\n\n\tgetData() {\n\t\treturn this.#data;\n\t}\n\n\tgetCode() {\n\t\treturn this.#code;\n\t}\n\n\tgetClientErrors() {\n\t\treturn this.#errors.filter(error => error.type === 'client');\n\t}\n\n\tgetErrors() {\n\t\treturn this.#errors;\n\t}\n\n\t/**\n\t * @returns {Array}\n\t */\n\tgetCriticalErrors() {\n\t\treturn this.#errors.filter(error => error.type === 'critical');\n\t}\n\n}\n\nclass PayloadExtension {\n\n\t/**\n\t * @param {PayloadResponse} payload\n\t */\n\tbefore(payload) {\n\n\t}\n\n\t/**\n\t * @param {PayloadResponse} payload\n\t */\n\tafter(payload) {\n\n\t}\n\n}\n\nexport default class PayloadResponseFactory {\n\n\t#clientErrorProcessors = [];\n\n\t/** @var {PayloadExtension[]} */\n\t#extensions = [];\n\n\t/**\n\t * @param {PayloadExtension} extension\n\t */\n\taddExtension(extension) {\n\t\tthis.#extensions.push(extension);\n\t}\n\n\taddClientErrorProcessor(processor) {\n\t\tthis.#clientErrorProcessors.push(processor);\n\t}\n\n\t/**\n\t * @param {Promise<Response>} fetch\n\t * @return {Promise<PayloadResponse>}\n\t */\n\tasync createFetch(fetch) {\n\t\treturn new PayloadResponse(\n\t\t\tawait (await fetch).json(),\n\t\t\tthis.#clientErrorProcessors,\n\t\t\tthis.#extensions,\n\t\t);\n\t}\n\n}\n"],"names":[],"mappings":"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"}